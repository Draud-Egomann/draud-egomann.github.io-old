@page "/about"
@using Web.Components.Components;
@using Web.Helper
@using Web.Models
@implements IDisposable;

<PageTitle>Justin Urbanek - Über mich</PageTitle>

<HeroBanner Title="Lorem Ipsum dolor"
            SubTitle="sit amet consectetur adipisici elit..."
            HasButton="false"
            IsBigView="false" />

@* ContentGrid2 *@
<div class="w-full relative own-bg-primary">
  <div class="container flex flex-wrap lg:flex-nowrap justify-around items-center gap-8 py-12">
    <div class="w-full lg:w-1/3 flex flex-col items-center gap-8 mx-8 py-12 lg:py-48 px-12 lg:px-0">
      <Heading Size="HeadingSize.Is2" Class="text-white">
        Lorem Ipsum dolor
      </Heading>

      <Paragraph Class="text-white">
        Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore
        et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum.
        Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit
        amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam
        erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren,
        no sea takimata sanctus est Lorem ipsum dolor sit amet.
      </Paragraph>
    </div>

    <div class="hidden lg:block w-full lg:w-2/3 relative">
      @foreach (var image in Images) {
        <img src=@image.ImageUrl alt=@image.AltText class="static lg:absolute shadow-gray-800 shadow-md @(image.Position)" />
      }
    </div>

    <div class="block lg:hidden w-full h-96 relative own-bg-primary whitespace-nowrap overflow-hidden">
      @foreach (var image in Images) {
        <div class="inline-block w-full h-96 image" style="transform: translateX(@(image.TranslateX)px);">
          <img class="w-full h-full object-cover" src=@image.ImageUrl alt=@image.AltText />
        </div>
      }

      <div class="w-20 h-full absolute top-0 left-0 bg-gradient-to-r from-[#1D2328] to-transparent"></div>
      <div class="w-20 h-full absolute top-0 right-0 bg-gradient-to-l from-[#1D2328] to-transparent"></div>
    </div>
  </div>
</div>

<style>
  .image {
    transition: transform 0.4s linear;
  }
</style>

@code {
  private List<HorizontalGalleryImage> Images;
  private System.Timers.Timer timer;

  protected override void OnInitialized() {
    base.OnInitialized();

    for (int i = 0; i < 5; i++) {
      Images = HorizontalGalleryImageHelper.GetGalleryImages();
    }

    // Set up the timer
    timer = new System.Timers.Timer(50);
    timer.Elapsed += UpdateImages;
    timer.Start();
  }

  private void UpdateImages(object sender, System.Timers.ElapsedEventArgs e) {
    InvokeAsync(() => {
      var containerWidth = 768; // Width of a single card

      foreach (var image in Images) {
        image.TranslateX -= 2; // Adjust movement speed as needed

        if (image.TranslateX <= (-containerWidth * image.Id) - containerWidth) {
          image.TranslateX += (containerWidth * Images.Count);
        }
      }

      StateHasChanged();
    });
  }

  public void Dispose() {
    timer?.Dispose();
  }
}